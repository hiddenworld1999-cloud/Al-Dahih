<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <script>
        if (localStorage.getItem('isLoggedInDaheeh') !== 'true') {
            window.location.href = 'login.html';
        }
        document.addEventListener('contextmenu', event => event.preventDefault());
        document.addEventListener('keydown', function(e) {
            if (e.key === 'PrintScreen' || (e.ctrlKey && (e.key === 's' || e.key === 'c' || e.key === 'p' || e.key === 'u'))) {
                alert('Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù…Ø­Ù…ÙŠ.');
                e.preventDefault();
            }
        });
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¯Ø­ÙŠØ­ - El-Daheeh App</title>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@400;500;700;900&family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <style>
        /* === Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ© Ù„Ù„Ø£Ù„ÙˆØ§Ù† === */
        :root { 
            --primary-blue: #0A2647; 
            --accent-orange: #FFC800; 
            --bg-main: #F8F9FA; 
            --bg-card: #ffffff;
            --text-main: #212529;
            --text-grey: #6c757d;
            --title-color: #0A2647;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.08);
            --nav-inactive: #adb5bd;
            --border-color: #e9ecef;
            --calc-bg: #f8f9fa;
            --calc-btn: #ffffff;
            --filter-bg: #e9ecef;
            --filter-text: #495057;
            --summary-bg: #ffffff;
            --quiz-option-bg: #f1f3f5;
        }

        body.dark-mode {
            --bg-main: #121212; 
            --bg-card: #1E1E1E;
            --text-main: #E8EAED;
            --text-grey: #9AA0A6;
            --title-color: #FFC800; 
            --card-shadow: 0 4px 12px rgba(0,0,0,0.5);
            --nav-inactive: #5f6368;
            --border-color: #333;
            --calc-bg: #2d2d2d;
            --calc-btn: #3e3e3e;
            --filter-bg: #333;
            --filter-text: #E8EAED;
            --summary-bg: #1E1E1E;
            --quiz-option-bg: #2d2d2d;
        }

        .material-icons { font-family: 'Material Icons'; font-weight: normal; font-size: 24px; display: inline-block; line-height: 1; direction: ltr; }
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; transition: background-color 0.3s, color 0.3s; }
        
        body { font-family: 'IBM Plex Sans Arabic', sans-serif; background-color: var(--bg-main); color: var(--text-main); padding-bottom: 80px; overflow-x: hidden; user-select: none; -webkit-user-select: none; }
        html[lang="en"] body { font-family: 'Poppins', sans-serif; }

        .page-section { display: none; animation: fadeIn 0.3s ease; }
        .page-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .app-header { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; background: var(--bg-card); position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .logo-text { font-size: 1.3rem; font-weight: 700; color: var(--title-color); display: flex; align-items: center; gap: 8px; }
        .logo-icon { color: var(--accent-orange); font-size: 28px; margin: 0 !important; }
        .header-icons { display: flex; align-items: center; gap: 15px; }
        html[dir="rtl"] .search-icon-inside { right: 15px; } html[dir="ltr"] .search-icon-inside { left: 15px; }
        
        .news-ticker { background: var(--accent-orange); display: flex; align-items: center; padding: 8px 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .news-ticker .material-icons { color: #0A2647; font-size: 22px; margin: 0 10px; }
        .news-ticker marquee { color: #0A2647; font-weight: 700; font-size: 0.95rem; padding-top: 3px; }

        .hero-section { padding: 20px 20px 10px 20px; background: var(--bg-card); border-bottom-left-radius: 25px; border-bottom-right-radius: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); }
        .welcome-text { margin-bottom: 15px; }
        .search-input { width: 100%; padding: 14px 45px; border: none; border-radius: 15px; background: var(--bg-main); color: var(--text-main); font-size: 0.95rem; }
        .search-input::placeholder { color: var(--text-grey); }
        .search-container { position: relative; }
        .search-icon-inside { position: absolute; top: 50%; transform: translateY(-50%); color: var(--title-color); opacity: 0.6; }
        
        .categories-wrapper { margin-top: 20px; overflow-x: auto; white-space: nowrap; padding-bottom: 10px; -ms-overflow-style: none; scrollbar-width: none; }
        .categories-wrapper::-webkit-scrollbar { display: none; }
        .cat-btn { display: inline-block; padding: 8px 20px; background: var(--filter-bg); color: var(--filter-text); border-radius: 20px; margin-inline-end: 10px; font-size: 0.85rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; border: 1px solid transparent; }
        .cat-btn.active { background: var(--primary-blue); color: white; box-shadow: 0 4px 10px rgba(10, 38, 71, 0.3); }
        
        .container { padding: 0 20px; }
        .section-title { font-size: 1.1rem; margin: 25px 0 15px 0; color: var(--title-color); }
        
        .course-card-vertical { background: var(--bg-card); border-radius: 18px; overflow: hidden; margin-bottom: 18px; box-shadow: var(--card-shadow); display: flex; cursor: pointer; position: relative; }
        .cc-v-image { width: 110px; object-fit: cover; }
        .cc-v-content { padding: 15px; flex: 1; display: flex; flex-direction: column; justify-content: space-between; }
        .completed-badge { display: none; background: #e8f5e9; color: #2e7d32; padding: 3px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: bold; margin-bottom: 5px; width: fit-content; }
        .course-card-vertical.is-completed .completed-badge { display: flex; align-items: center; gap: 4px; }

        /* ØµÙØ­Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ */
        .profile-header-card { background: linear-gradient(135deg, var(--primary-blue), #1a3c63); border-radius: 20px; padding: 30px 20px; text-align: center; position: relative; overflow: hidden; margin-top: 20px; box-shadow: var(--card-shadow); }
        .profile-header-card::after { content: ''; position: absolute; top: -40px; right: -40px; width: 120px; height: 120px; background: rgba(255, 200, 0, 0.1); border-radius: 50%; }
        .avatar-container { width: 90px; height: 90px; background: white; border-radius: 50%; display: flex; justify-content: center; align-items: center; margin: 0 auto 15px auto; box-shadow: 0 4px 10px rgba(0,0,0,0.2); position: relative; z-index: 2; border: 3px solid var(--accent-orange); }
        .avatar-container .material-icons { font-size: 60px; color: var(--primary-blue); }
        .profile-stats-box { display: flex; justify-content: space-around; background: var(--bg-card); padding: 20px 10px; border-radius: 18px; margin-top: -25px; position: relative; z-index: 3; box-shadow: var(--card-shadow); margin-bottom: 25px; }
        .stat-item { text-align: center; flex: 1; border-inline-start: 1px solid var(--border-color); }
        .stat-item:first-child { border-inline-start: none; }
        .stat-value { font-size: 1.3rem; font-weight: 900; color: var(--title-color); }
        .stat-label { font-size: 0.75rem; color: var(--text-grey); margin-top: 4px; }
        
        .settings-list { background: var(--bg-card); border-radius: 18px; padding: 5px 0; box-shadow: var(--card-shadow); }
        .settings-item { display: flex; flex-direction: row; align-items: center; justify-content: space-between; padding: 16px 20px; border-bottom: 1px solid var(--border-color); cursor: pointer; }
        .settings-item:last-child { border-bottom: none; }
        .settings-item-right { display: flex; flex-direction: row; align-items: center; gap: 15px; }
        .settings-icon { width: 38px; height: 38px; border-radius: 10px; display: flex; justify-content: center; align-items: center; color: white; flex-shrink: 0; margin: 0; }
        .settings-text { font-weight: 600; font-size: 0.95rem; color: var(--text-main); margin: 0; padding: 0; }
        
        .logout-btn-new { width: 100%; padding: 16px; background: rgba(211, 47, 47, 0.08); color: #d32f2f; border: 2px solid rgba(211, 47, 47, 0.2); border-radius: 15px; font-weight: 700; font-family: inherit; margin-top: 25px; cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 8px; transition: background 0.2s; }

        /* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ ÙˆØ§Ù„Ø¨Ù†Ùƒ ÙˆØ§Ù„ÙƒØ´ÙƒÙˆÙ„ */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: var(--bg-card); display: flex; justify-content: space-around; padding: 12px 5px; box-shadow: 0 -4px 15px rgba(0,0,0,0.06); z-index: 200; border-top-left-radius: 20px; border-top-right-radius: 20px; }
        .nav-item { display: flex; flex-direction: column; align-items: center; font-size: 0.7rem; color: var(--nav-inactive); flex: 1; cursor: pointer; }
        .nav-item.active { color: var(--title-color); font-weight: 700; }

        .player-header { padding: 15px; display: flex; align-items: center; background: var(--bg-card); box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .back-btn { font-size: 24px; color: var(--title-color); cursor: pointer; padding: 5px; margin-inline-end: 15px; }
        html[dir="ltr"] .back-btn { transform: rotate(180deg); }
        .course-details-header { padding: 25px 20px; background: var(--bg-card); margin-bottom: 25px; }
        
        .qb-button { padding: 20px; border-radius: 16px; border: none; font-family: inherit; font-size: 1.1rem; font-weight: 700; display: flex; align-items: center; justify-content: space-between; cursor: pointer; width: 100%; margin-bottom: 15px; box-shadow: var(--card-shadow); transition: all 0.3s; text-align: start; }
        .qb-btn-answers { background: var(--accent-orange); color: #0A2647; }
        .qb-btn-quiz { background: transparent; color: var(--title-color); border: 2px solid var(--title-color); }
        .qb-btn-summary { background: #E3F2FD; color: #0D47A1; border: 2px solid #90CAF9; }
        body.dark-mode .qb-btn-summary { background: rgba(13, 71, 161, 0.2); color: #90CAF9; border: 2px solid #1976D2; }

        /* Ø§Ù„ÙƒØ´ÙƒÙˆÙ„ */
        .notebook-container { background: var(--bg-card); border-radius: 18px; padding: 20px; box-shadow: var(--card-shadow); margin-top: 15px; height: calc(100vh - 220px); display: flex; flex-direction: column; }
        .notebook-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }
        .save-indicator { font-size: 0.85rem; color: #2e7d32; display: flex; align-items: center; gap: 5px; opacity: 0; transition: opacity 0.3s; font-weight: bold; }
        .notebook-textarea { flex: 1; width: 100%; border: none; resize: none; background: transparent; color: var(--text-main); font-family: inherit; font-size: 1.05rem; line-height: 1.8; outline: none; }
        .notebook-textarea::placeholder { color: var(--text-grey); opacity: 0.6; }

        /* === Ø¹Ø§Ø±Ø¶ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ© Ø§Ù„Ù…Ø¯Ù…Ø¬Ø© Ø¨Ø§Ù„ÙˆØ±Ù‚Ø© === */
        .image-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 500; display: none; flex-direction: column; }
        .modal-header { padding: 15px; background: #111; display: flex; justify-content: space-between; align-items: center; z-index: 601; border-bottom: 1px solid #333; }
        .close-img-btn { color: white; background: #d32f2f; border: none; padding: 8px 20px; border-radius: 12px; font-weight: bold; cursor: pointer; }
        .zoom-controls { display: flex; gap: 15px; background: #333; padding: 5px 15px; border-radius: 20px; }
        .zoom-controls .material-icons { color: white; font-size: 26px; cursor: pointer; }
        
        .images-scroll-container { flex: 1; overflow-y: auto; overflow-x: auto; width: 100%; padding: 10px; background: #f0f0f0; }
        
        /* Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù„ÙŠ Ø¨ÙŠÙ„Ù… Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ© Ù…Ø¹ Ø¨Ø¹Ø¶ Ø¹Ø´Ø§Ù† ÙŠÙ†Ø¯Ù…Ø¬ÙˆØ§ */
        .images-wrapper { position: relative; width: 100%; min-height: 100%; display: flex; flex-direction: column; align-items: center; margin: 0 auto; transition: width 0.2s ease; }
        
        .protected-img { width: 100%; height: auto; margin-bottom: 15px; border-radius: 4px; pointer-events: none; -webkit-user-drag: none; display: block; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); z-index: 1; }
        
        /* Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ© Ø¨Ù‚Øª Absolute Ø¬ÙˆÙ‡ Ø§Ù„Ù€ Wrapper Ù…Ø´ FixedØŒ Ø¹Ø´Ø§Ù† ØªÙ†Ø²Ù„ Ù…Ø¹ Ø§Ù„ØµÙˆØ± Ù„Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ø°ÙƒØ±Ø© */
        .watermark-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; display: flex; flex-wrap: wrap; justify-content: center; align-content: flex-start; overflow: hidden; z-index: 10; }
        .watermark-text { color: rgba(0, 0, 0, 0.15); font-size: 26px; font-weight: 900; transform: rotate(-45deg); padding: 80px; white-space: nowrap; text-shadow: none; user-select: none; }
        body.dark-mode .watermark-text { color: rgba(255, 255, 255, 0.2); }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù„Ø®ØµØ§Øª */
        .summary-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-main); z-index: 500; display: none; flex-direction: column; overflow: hidden; }
        .summary-header { padding: 15px 20px; background: var(--primary-blue); display: flex; justify-content: space-between; align-items: center; color: white; box-shadow: 0 2px 10px rgba(0,0,0,0.2); z-index: 501; }
        .summary-body { flex: 1; overflow-y: auto; padding: 20px; background: var(--bg-main); }
        .lecture-btn { width: 100%; padding: 18px; background: var(--bg-card); color: var(--title-color); border: 1px solid var(--border-color); border-radius: 12px; margin-bottom: 12px; font-size: 1.05rem; font-weight: bold; text-align: start; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .lecture-content-view { display: none; background: var(--bg-card); padding: 25px 20px; border-radius: 15px; box-shadow: var(--card-shadow); line-height: 1.8; font-size: 1rem; color: var(--text-main); }
        .lecture-content-view h3 { color: var(--primary-blue); border-bottom: 2px solid var(--accent-orange); padding-bottom: 10px; margin-bottom: 15px; }
        body.dark-mode .lecture-content-view h3 { color: var(--accent-orange); }

        /* Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ */
        .quiz-container { background: var(--bg-card); padding: 25px; border-radius: 20px; box-shadow: var(--card-shadow); margin-top: 10px; }
        .quiz-progress { display: flex; justify-content: space-between; margin-bottom: 15px; font-size: 0.9rem; color: var(--text-grey); font-weight: bold; }
        .quiz-question { font-size: 1.2rem; font-weight: bold; color: var(--title-color); margin-bottom: 25px; line-height: 1.5; }
        .quiz-option { width: 100%; padding: 15px; background: var(--quiz-option-bg); border: 2px solid transparent; border-radius: 12px; text-align: start; margin-bottom: 12px; font-size: 1rem; font-family: inherit; font-weight: 500; color: var(--text-main); cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: space-between; }
        .quiz-option:hover { background: rgba(10, 38, 71, 0.05); }
        .quiz-option.selected { border-color: var(--primary-blue); background: rgba(10, 38, 71, 0.1); }
        .quiz-option.correct { border-color: #2e7d32; background: #e8f5e9; color: #2e7d32; }
        .quiz-option.wrong { border-color: #d32f2f; background: #ffebee; color: #d32f2f; }
        .quiz-next-btn { width: 100%; padding: 15px; background: var(--primary-blue); color: white; border: none; border-radius: 12px; font-size: 1.1rem; font-weight: bold; font-family: inherit; cursor: pointer; margin-top: 15px; display: none; }
        .quiz-result-box { text-align: center; padding: 30px 10px; }
        .quiz-score { font-size: 3rem; font-weight: 900; color: var(--accent-orange); margin: 15px 0; }

        /* Ø§Ù„Ù…Ø¤Ù‚Øª ÙˆØ§Ù„Ø¢Ù„Ø© Ø§Ù„Ø­Ø§Ø³Ø¨Ø© */
        .pomodoro-container { position: fixed; bottom: 90px; z-index: 400; display: flex; flex-direction: column; align-items: center; }
        html[dir="rtl"] .pomodoro-container { left: 20px; align-items: flex-end; } html[dir="ltr"] .pomodoro-container { right: 20px; align-items: flex-end; }
        .pomo-fab { width: 55px; height: 55px; border-radius: 50%; background: var(--accent-orange); color: #0A2647; border: none; box-shadow: 0 4px 15px rgba(0,0,0,0.3); cursor: pointer; display: flex; justify-content: center; align-items: center; transition: transform 0.2s; }
        .pomo-timer { background: var(--bg-card); padding: 15px; border-radius: 15px; box-shadow: var(--card-shadow); margin-bottom: 15px; border: 2px solid var(--accent-orange); width: 180px; text-align: center; display: none; }
        .pomo-header { font-size: 0.9rem; color: var(--title-color); font-weight: bold; display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .pomo-time { font-size: 2.2rem; font-weight: 900; color: var(--primary-blue); margin-bottom: 15px; direction: ltr; font-family: monospace; }
        .pomo-controls { display: flex; justify-content: center; gap: 10px; }
        .pomo-controls button { background: var(--primary-blue); color: white; border: none; padding: 8px 15px; border-radius: 8px; cursor: pointer; font-family: inherit; font-weight: bold; flex: 1; }
        
        .calculator-modal { position: fixed; top: 70px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 320px; background: var(--bg-card); padding: 20px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); z-index: 500; display: none; border: 1px solid var(--border-color); direction: ltr; }
        .calc-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .calc-title { font-weight: bold; color: var(--title-color); display: flex; align-items: center; gap: 5px; }
        .calc-display { width: 100%; height: 60px; background: var(--calc-bg); border: none; border-radius: 12px; font-size: 1.8rem; text-align: right; padding: 10px; color: var(--title-color); font-family: monospace; margin-bottom: 15px; outline: none; }
        .calc-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        .calc-btn { padding: 15px; border: none; border-radius: 12px; font-size: 1.2rem; font-weight: bold; cursor: pointer; background: var(--calc-btn); color: var(--text-main); transition: background 0.2s; }
        .calc-btn.op { background: rgba(10, 38, 71, 0.1); color: var(--primary-blue); }
        .calc-btn.eq { background: var(--accent-orange); color: var(--primary-blue); grid-column: span 2; }
    </style>
</head>
<body>
    <header class="app-header" id="mainHeader">
        <div class="logo-text">
            <span class="material-icons logo-icon">local_library</span>
            <span data-ar="Ø§Ù„Ø¯Ø­ÙŠØ­" data-en="El-Daheeh">Ø§Ù„Ø¯Ø­ÙŠØ­</span>
        </div>
        <div class="header-icons">
            <span class="material-icons" onclick="toggleLanguage()" style="color:var(--title-color); font-size: 26px; cursor:pointer;">language</span>
            <span class="material-icons" onclick="toggleCalculator()" style="color:var(--title-color); font-size: 26px; cursor:pointer;">calculate</span>
            <span class="material-icons" id="musicToggle" style="color:var(--title-color); font-size: 26px; cursor:pointer;" onclick="toggleMusic()">music_off</span>
            <span class="material-icons" id="darkModeToggle" style="color:var(--title-color); font-size: 26px; cursor:pointer;" onclick="toggleDarkMode()">dark_mode</span>
        </div>
    </header>

    <div id="calculatorModal" class="calculator-modal">
        <div class="calc-header">
            <span class="calc-title"><span class="material-icons" style="font-size:20px;">calculate</span> <span data-ar="Ø¢Ù„Ø© Ø­Ø§Ø³Ø¨Ø©" data-en="Calculator">Ø¢Ù„Ø© Ø­Ø§Ø³Ø¨Ø©</span></span>
            <span class="material-icons" onclick="toggleCalculator()" style="cursor:pointer; color:var(--text-grey);">close</span>
        </div>
        <input type="text" id="calcDisplay" class="calc-display" readonly>
        <div class="calc-grid">
            <button class="calc-btn" style="background: #ffebee; color: #d32f2f;" onclick="clearCalc()">C</button>
            <button class="calc-btn op" onclick="appendCalc('/')">/</button>
            <button class="calc-btn op" onclick="appendCalc('*')">Ã—</button>
            <button class="calc-btn op" onclick="appendCalc('-')">-</button>
            <button class="calc-btn" onclick="appendCalc('7')">7</button>
            <button class="calc-btn" onclick="appendCalc('8')">8</button>
            <button class="calc-btn" onclick="appendCalc('9')">9</button>
            <button class="calc-btn op" onclick="appendCalc('+')">+</button>
            <button class="calc-btn" onclick="appendCalc('4')">4</button>
            <button class="calc-btn" onclick="appendCalc('5')">5</button>
            <button class="calc-btn" onclick="appendCalc('6')">6</button>
            <button class="calc-btn eq" onclick="calculateResult()">=</button>
            <button class="calc-btn" onclick="appendCalc('1')">1</button>
            <button class="calc-btn" onclick="appendCalc('2')">2</button>
            <button class="calc-btn" onclick="appendCalc('3')">3</button>
            <button class="calc-btn" onclick="appendCalc('0')">0</button>
        </div>
    </div>

    <audio id="bgMusic" loop><source src="music.mp3" type="audio/mpeg"></audio>

    <div class="news-ticker">
        <span class="material-icons">campaign</span>
        <marquee direction="right" scrollamount="5">
            <span data-ar="ğŸ§ Ø¬Ø¯ÙŠØ¯: ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø¥Ù„Ù‰ Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØªÙØ§Ø¹Ù„ÙŠ! Ø§Ø®ØªØ¨Ø± Ù†ÙØ³Ùƒ Ø§Ù„Ø¢Ù† ğŸš€" data-en="ğŸ§ New: Interactive electronic quizzes added! Test yourself now ğŸš€">
                ğŸ§ Ø¬Ø¯ÙŠØ¯: ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø¥Ù„Ù‰ Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØªÙØ§Ø¹Ù„ÙŠ! Ø§Ø®ØªØ¨Ø± Ù†ÙØ³Ùƒ Ø§Ù„Ø¢Ù† ğŸš€
            </span>
        </marquee>
    </div>

    <div class="pomodoro-container">
        <div id="pomodoroTimer" class="pomo-timer">
            <div class="pomo-header">
                <span data-ar="Ù…Ø¤Ù‚Øª Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©" data-en="Study Timer">Ù…Ø¤Ù‚Øª Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©</span>
                <span class="material-icons" onclick="togglePomodoro()" style="cursor:pointer; font-size:20px;">close</span>
            </div>
            <div class="pomo-time" id="pomoTimeDisplay">25:00</div>
            <div class="pomo-controls">
                <button onclick="startPomodoro()" id="pomoStartBtn" data-ar="Ø¨Ø¯Ø£" data-en="Start">Ø¨Ø¯Ø£</button>
                <button class="pomo-reset" onclick="resetPomodoro()" data-ar="Ø¥Ø¹Ø§Ø¯Ø©" data-en="Reset">Ø¥Ø¹Ø§Ø¯Ø©</button>
            </div>
        </div>
        <button id="pomoFab" class="pomo-fab" onclick="togglePomodoro()">
            <span class="material-icons" style="font-size: 28px;">timer</span>
        </button>
    </div>

    <div id="page-home" class="page-section active">
        <section class="hero-section">
            <div class="welcome-text">
                <h2 style="color: var(--title-color);"><span data-ar="Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ÙŠØ§ " data-en="Welcome, ">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ÙŠØ§ </span><span id="welcomeName">Ø¯Ø­ÙŠØ­</span> ğŸ‘‹</h2>
                <p id="motivationQuote" style="color: var(--text-grey); font-weight: 500; font-size: 0.95rem; margin-top: 8px; line-height: 1.5;"></p>
            </div>
            <div class="search-container">
                <span class="material-icons search-icon-inside">search</span>
                <input type="text" id="searchInput" class="search-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø§Ø¯Ø©..." data-ph-ar="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø§Ø¯Ø©..." data-ph-en="Search for a course...">
            </div>

            <div class="categories-wrapper">
                <span class="cat-btn active" onclick="filterCourses('all', this)" data-ar="Ø§Ù„ÙƒÙ„" data-en="All">Ø§Ù„ÙƒÙ„</span>
                <span class="cat-btn" onclick="filterCourses('cs', this)" data-ar="Ø­Ø§Ø³Ø¨ Ø¢Ù„ÙŠ" data-en="CS">Ø­Ø§Ø³Ø¨ Ø¢Ù„ÙŠ</span>
                <span class="cat-btn" onclick="filterCourses('management', this)" data-ar="Ø¥Ø¯Ø§Ø±Ø©" data-en="Management">Ø¥Ø¯Ø§Ø±Ø©</span>
                <span class="cat-btn" onclick="filterCourses('economics', this)" data-ar="Ø§Ù‚ØªØµØ§Ø¯" data-en="Economics">Ø§Ù‚ØªØµØ§Ø¯</span>
                <span class="cat-btn" onclick="filterCourses('stats', this)" data-ar="Ø¥Ø­ØµØ§Ø¡" data-en="Statistics">Ø¥Ø­ØµØ§Ø¡</span>
            </div>
        </section>
        
        <div class="container">
            <h3 class="section-title" data-ar="Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©" data-en="Courses">Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</h3>
            <div id="coursesListContainer"></div>
        </div>
    </div>

    <div id="page-courses" class="page-section">
        <div class="container">
            <h3 class="section-title" style="margin-top:20px" data-ar="Ø¯ÙˆØ±Ø§ØªÙŠ Ø§Ù„Ù…Ø³Ø¬Ù„Ø©" data-en="My Courses">Ø¯ÙˆØ±Ø§ØªÙŠ Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</h3>
            <div style="text-align:center; padding:50px 0; color:var(--text-grey);">
                <span class="material-icons" style="font-size:60px;">school</span>
                <p data-ar="Ø£Ù†Øª Ù…Ø´ØªØ±Ùƒ ÙÙŠ 5 Ø¯ÙˆØ±Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹" data-en="You are enrolled in 5 courses">Ø£Ù†Øª Ù…Ø´ØªØ±Ùƒ ÙÙŠ 5 Ø¯ÙˆØ±Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</p>
            </div>
        </div>
    </div>

    <div id="page-notebook" class="page-section">
        <div class="container">
            <h3 class="section-title" style="margin-top:20px; display: flex; align-items: center; gap: 8px;">
                <span class="material-icons" style="color: var(--accent-orange);">edit_note</span> 
                <span data-ar="ÙƒØ´ÙƒÙˆÙ„ÙŠ" data-en="My Notebook">ÙƒØ´ÙƒÙˆÙ„ÙŠ</span>
            </h3>
            <div class="notebook-container">
                <div class="notebook-header">
                    <span style="color: var(--text-grey); font-size: 0.85rem;" data-ar="ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¨ØªÙƒØªØ¨Ù‡Ø§ Ø¨ØªØªØ­ÙØ¸ Ù„ÙˆØ­Ø¯Ù‡Ø§.." data-en="Everything is auto-saved..">ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¨ØªÙƒØªØ¨Ù‡Ø§ Ø¨ØªØªØ­ÙØ¸ Ù„ÙˆØ­Ø¯Ù‡Ø§..</span>
                    <span id="saveIndicator" class="save-indicator"><span class="material-icons" style="font-size: 16px;">check_circle</span> <span data-ar="ØªÙ… Ø§Ù„Ø­ÙØ¸" data-en="Saved">ØªÙ… Ø§Ù„Ø­ÙØ¸</span></span>
                </div>
                <textarea id="studentNotebook" class="notebook-textarea" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ Ù‡Ù†Ø§..." data-ph-ar="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ Ù‡Ù†Ø§..." data-ph-en="Write your notes here..."></textarea>
            </div>
        </div>
    </div>

    <div id="page-profile" class="page-section">
        <div class="container">
            <div class="profile-header-card">
                <div class="avatar-container"><span class="material-icons">person</span></div>
                <h2 id="profileName" style="font-size: 1.4rem; margin-bottom: 5px; position: relative; z-index: 2; color: white;">...</h2>
                <p id="profileCode" style="color: rgba(255,255,255,0.7); font-size: 0.9rem; position: relative; z-index: 2;">...</p>
            </div>
            <div class="profile-stats-box">
                <div class="stat-item"><div class="stat-value">5</div><div class="stat-label" data-ar="Ù…ÙˆØ§Ø¯ Ù…Ø³Ø¬Ù„Ø©" data-en="Enrolled">Ù…ÙˆØ§Ø¯ Ù…Ø³Ø¬Ù„Ø©</div></div>
                <div class="stat-item"><div class="stat-value" id="completedCountBadge">0</div><div class="stat-label" data-ar="Ù…ÙˆØ§Ø¯ Ù…ÙƒØªÙ…Ù„Ø©" data-en="Completed">Ù…ÙˆØ§Ø¯ Ù…ÙƒØªÙ…Ù„Ø©</div></div>
                <div class="stat-item"><div class="stat-value" style="color: var(--accent-orange);" data-ar="Ø¯Ø­ÙŠØ­" data-en="Pro">Ø¯Ø­ÙŠØ­</div><div class="stat-label" data-ar="Ø§Ù„Ù…Ø³ØªÙˆÙ‰" data-en="Level">Ø§Ù„Ù…Ø³ØªÙˆÙ‰</div></div>
            </div>
            <div class="settings-list">
                <div class="settings-item" onclick="toggleDarkMode()">
                    <div class="settings-item-right"><div class="settings-icon" style="background: var(--title-color);"><span class="material-icons">dark_mode</span></div><span class="settings-text" data-ar="ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ" data-en="Dark Mode">ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</span></div>
                </div>
                <a href="intent://resolve?domain=Hidden2003A#Intent;scheme=tg;package=org.telegram.messenger;S.browser_fallback_url=https%3A%2F%2Ft.me%2FHidden2003A;end" class="settings-item" style="text-decoration: none; color: inherit;">
                    <div class="settings-item-right"><div class="settings-icon" style="background: #2196f3;"><span class="material-icons">support_agent</span></div><span class="settings-text" data-ar="ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ" data-en="Contact Support">ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</span></div>
                    <span class="material-icons" style="color: var(--text-grey);">chevron_left</span>
                </a>
            </div>
            <button class="logout-btn-new" onclick="logout()"><span class="material-icons">logout</span><span data-ar="ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬" data-en="Logout">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span></button>
        </div>
    </div>

    <div id="page-player" class="page-section" style="position:fixed; top:0; left:0; width:100%; height:100%; background:var(--bg-main); z-index:300; display:none; overflow-y: auto;">
        <div class="player-header"><span class="material-icons back-btn" onclick="closePlayer()">arrow_forward</span><span style="font-weight:700; color: var(--title-color);" data-ar="Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø§Ø¯Ø©" data-en="Course Options">Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø§Ø¯Ø©</span></div>
        <div class="course-details-header">
            <h2 id="playerCourseTitle" style="color: var(--title-color); margin-bottom: 5px;"></h2>
            <p id="playerInstructor" style="color: var(--text-grey); font-size: 0.9rem;"></p>
        </div>
        <div class="container">
            <h3 class="section-title" data-ar="Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©" data-en="Choose Study Method">Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©</h3>
            
            <button class="qb-button qb-btn-summary" onclick="openSummaryModal()">
                <div>
                    <div style="margin-bottom: 5px;" data-ar="Ù…Ù„Ø®ØµØ§Øª Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª" data-en="Lecture Summaries">Ù…Ù„Ø®ØµØ§Øª Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª</div>
                    <div style="font-size: 0.85rem; opacity: 0.8;" data-ar="Ø®Ù„Ø§ØµØ© Ø§Ù„Ø´Ø±Ø­ ÙÙŠ ÙƒØ¨Ø³ÙˆÙ„Ø©" data-en="The essence of the explanation">Ø®Ù„Ø§ØµØ© Ø§Ù„Ø´Ø±Ø­ ÙÙŠ ÙƒØ¨Ø³ÙˆÙ„Ø©</div>
                </div>
                <span class="material-icons">menu_book</span>
            </button>

            <button class="qb-button qb-btn-answers" onclick="showProtectedImage('answers')">
                <div>
                    <div style="margin-bottom: 5px;" data-ar="Ø£Ø³Ø¦Ù„Ø© Ø¨Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª" data-en="Questions with Answers">Ø£Ø³Ø¦Ù„Ø© Ø¨Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª</div>
                    <div style="font-size: 0.85rem; opacity: 0.8;" data-ar="Ù„Ù„Ù…Ø°Ø§ÙƒØ±Ø© ÙˆØ§Ù„ÙÙ‡Ù… Ø§Ù„Ø¹Ù…ÙŠÙ‚" data-en="For studying and deep understanding">Ù„Ù„Ù…Ø°Ø§ÙƒØ±Ø© ÙˆØ§Ù„ÙÙ‡Ù… Ø§Ù„Ø¹Ù…ÙŠÙ‚</div>
                </div>
                <span class="material-icons">fact_check</span>
            </button>
            
            <button class="qb-button qb-btn-quiz" onclick="openQuizModal()">
                <div>
                    <div style="margin-bottom: 5px;" data-ar="Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" data-en="Interactive Quiz">Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</div>
                    <div style="font-size: 0.85rem; color: var(--text-grey);" data-ar="Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ ÙˆØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù†ØªÙŠØ¬Ø©" data-en="Test your knowledge and see the score">Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ ÙˆØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù†ØªÙŠØ¬Ø©</div>
                </div>
                <span class="material-icons">touch_app</span>
            </button>

            <button id="completeCourseBtn" class="qb-button" onclick="toggleCourseCompletion()" style="margin-top: 25px;">
                <div><div id="completeBtnText">ØªØ­Ø¯ÙŠØ¯ ÙƒÙ…Ø§Ø¯Ø© Ù…ÙƒØªÙ…Ù„Ø©</div></div>
                <span class="material-icons" id="completeBtnIcon">radio_button_unchecked</span>
            </button>
        </div>
    </div>

    <div id="summaryModal" class="summary-modal">
        <div class="summary-header">
            <span class="material-icons" id="summaryCloseBtn" onclick="closeSummaryModal()" style="cursor: pointer; font-size: 28px;">arrow_forward</span>
            <span style="font-weight: bold; font-size: 1.2rem;" id="summaryModalTitle" data-ar="Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª" data-en="Lectures List">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª</span>
            <span style="width: 28px;"></span>
        </div>
        <div class="summary-body" id="summaryBodyArea"></div>
    </div>

    <div id="quizModal" class="summary-modal">
        <div class="summary-header">
            <span class="material-icons" id="quizCloseBtn" onclick="closeQuizModal()" style="cursor: pointer; font-size: 28px;">arrow_forward</span>
            <span style="font-weight: bold; font-size: 1.2rem;" id="quizModalTitle" data-ar="Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ" data-en="Interactive Quiz">Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ</span>
            <span style="width: 28px;"></span>
        </div>
        <div class="summary-body">
            <div class="quiz-container" id="quizContainerBox"></div>
        </div>
    </div>

    <div id="imageModal" class="image-modal">
        <div class="modal-header">
            <button class="close-img-btn" onclick="closeImageModal()" data-ar="Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø®Ù„Ù" data-en="Go Back">Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø®Ù„Ù</button>
            <div class="zoom-controls">
                <span class="material-icons" onclick="zoomImages(20)">zoom_in</span>
                <span class="material-icons" onclick="zoomImages(-20)">zoom_out</span>
            </div>
        </div>
        <div class="images-scroll-container" id="imagesScrollBox">
            <div id="imagesWrapper" class="images-wrapper">
                <div id="watermarkOverlay" class="watermark-overlay"></div>
            </div>
        </div>
    </div>

    <nav class="bottom-nav" id="bottomNav">
        <div class="nav-item active" onclick="switchTab('home', this)"><span class="material-icons">home</span><span data-ar="Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©" data-en="Home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></div>
        <div class="nav-item" onclick="switchTab('courses', this)"><span class="material-icons">menu_book</span><span data-ar="Ø¯ÙˆØ±Ø§ØªÙŠ" data-en="Courses">Ø¯ÙˆØ±Ø§ØªÙŠ</span></div>
        <div class="nav-item" onclick="switchTab('notebook', this)"><span class="material-icons">edit_note</span><span data-ar="ÙƒØ´ÙƒÙˆÙ„ÙŠ" data-en="Notebook">ÙƒØ´ÙƒÙˆÙ„ÙŠ</span></div>
        <div class="nav-item" onclick="switchTab('home', this); document.getElementById('searchInput').focus();"><span class="material-icons">search</span><span data-ar="Ø¨Ø­Ø«" data-en="Search">Ø¨Ø­Ø«</span></div>
        <div class="nav-item" onclick="switchTab('profile', this)"><span class="material-icons">person</span><span data-ar="Ø­Ø³Ø§Ø¨ÙŠ" data-en="Profile">Ø­Ø³Ø§Ø¨ÙŠ</span></div>
    </nav>

    <script>
        // === Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø°ÙƒÙŠ ===
        let currentLang = localStorage.getItem('daheehLang') || 'ar';
        function toggleLanguage() { currentLang = currentLang === 'ar' ? 'en' : 'ar'; localStorage.setItem('daheehLang', currentLang); applyLanguage(); }
        function applyLanguage() {
            document.documentElement.dir = currentLang === 'en' ? 'ltr' : 'rtl';
            document.documentElement.lang = currentLang;
            document.querySelectorAll('[data-ar]').forEach(el => { el.innerText = el.getAttribute(`data-${currentLang}`); });
            document.querySelectorAll('[data-ph-ar]').forEach(el => { el.placeholder = el.getAttribute(`data-ph-${currentLang}`); });
            document.getElementById('summaryCloseBtn').innerText = currentLang === 'en' ? 'arrow_back' : 'arrow_forward';
            document.getElementById('quizCloseBtn').innerText = currentLang === 'en' ? 'arrow_back' : 'arrow_forward';
            renderCourses(coursesData); setRandomQuote(); if(currentCourse) updateCompletionUI();
        }

        // === Ø§Ù„Ø¢Ù„Ø© Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ùˆ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ ===
        function toggleCalculator() { const modal = document.getElementById('calculatorModal'); modal.style.display = modal.style.display === 'block' ? 'none' : 'block'; }
        function appendCalc(val) { document.getElementById('calcDisplay').value += val; }
        function clearCalc() { document.getElementById('calcDisplay').value = ''; }
        function calculateResult() { try { document.getElementById('calcDisplay').value = eval(document.getElementById('calcDisplay').value); } catch (e) { document.getElementById('calcDisplay').value = 'Error'; setTimeout(clearCalc, 1000); } }

        const bgMusic = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicToggle');
        bgMusic.volume = 0.5;
        function toggleMusic() { if (bgMusic.paused) { bgMusic.play().then(() => { musicBtn.innerText = 'music_note'; musicBtn.classList.add('music-active'); }).catch(error => alert("ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª.")); } else { bgMusic.pause(); musicBtn.innerText = 'music_off'; musicBtn.classList.remove('music-active'); } }

        const studentFullName = localStorage.getItem('studentName') || (currentLang==='en'?"Student":"Ø¯Ø­ÙŠØ­");
        const studentFirstName = studentFullName.split(' ')[0]; 
        document.getElementById('welcomeName').innerText = studentFirstName;
        const studentCode = localStorage.getItem('studentCode') || "---";
        document.getElementById('profileName').innerText = studentFullName;
        document.getElementById('profileCode').innerText = (currentLang==='en'?"Code: ":"ÙƒÙˆØ¯: ") + studentCode;

        const quotesAr = [`"ØªØ¹Ø¨ Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø© Ø¯Ù„ÙˆÙ‚ØªÙŠ Ø£Ø­Ø³Ù† Ù…Ù„ÙŠÙˆÙ† Ù…Ø±Ø© Ù…Ù† Ù†Ø¯Ù… Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¨Ø¹Ø¯ÙŠÙ† ÙŠØ§ ${studentFirstName}!"`, `"Ø§Ù„Ù†Ø¬Ø§Ø­ Ù…Ø´ Ø¨ÙŠÙŠØ¬ÙŠ ØµØ¯ÙØ©.. Ø¨ÙŠÙŠØ¬ÙŠ Ø¨Ø§Ù„Ø³Ù‡Ø± ÙˆØ§Ù„Ø­Ù„ Ø§Ù„ÙƒØªÙŠØ±. ÙƒÙ…Ù„ Ø·Ø±ÙŠÙ‚Ùƒ!"`];
        const quotesEn = [`"Studying now is better than regret later, ${studentFirstName}!"`, `"Success isn't an accident.. Keep going!"`];
        function setRandomQuote() { document.getElementById('motivationQuote').innerText = currentLang === 'en' ? quotesEn[Math.floor(Math.random() * quotesEn.length)] : quotesAr[Math.floor(Math.random() * quotesAr.length)]; }

        function toggleDarkMode() { document.body.classList.toggle('dark-mode'); localStorage.setItem('daheehDarkMode', document.body.classList.contains('dark-mode')); document.getElementById('darkModeToggle').innerText = document.body.classList.contains('dark-mode') ? 'light_mode' : 'dark_mode'; }
        if (localStorage.getItem('daheehDarkMode') === 'true') { document.body.classList.add('dark-mode'); document.getElementById('darkModeToggle').innerText = 'light_mode'; }

        const notebookInput = document.getElementById('studentNotebook'); const saveIndicator = document.getElementById('saveIndicator'); let typingTimer;
        if (localStorage.getItem('daheehNotebook')) { notebookInput.value = localStorage.getItem('daheehNotebook'); }
        notebookInput.addEventListener('input', function() { clearTimeout(typingTimer); saveIndicator.style.opacity = '0'; typingTimer = setTimeout(() => { localStorage.setItem('daheehNotebook', notebookInput.value); saveIndicator.style.opacity = '1'; setTimeout(() => { saveIndicator.style.opacity = '0'; }, 2000); }, 800); });

        // === Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ§Ø¯ + Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ (Quiz) ===
        const coursesData = [
            { 
                id: 1, category: 'cs', titleAr: "ØªØµÙ…ÙŠÙ… Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ø­Ø§Ø³Ø¨", titleEn: "Software Design", instructorAr: "Ø¯.Ø´ÙŠÙ…Ø§Ø¡ Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø¤ÙˆÙ", instructorEn: "Dr. Shaimaa", img: "cover_coding.jpg", files: { answers: { prefix: "coding_ans_", count: 10 } },
                quiz: [
                    { q: "Ù…Ø§ Ù‡ÙŠ Ø£ÙˆÙ„ Ù…Ø±Ø­Ù„Ø© ÙÙŠ Ø¯ÙˆØ±Ø© Ø­ÙŠØ§Ø© ØªØ·ÙˆÙŠØ± Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§ØªØŸ", options: ["Ø§Ù„ØªØµÙ…ÙŠÙ…", "Ø¬Ù…Ø¹ ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª", "Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©", "Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±"], answer: 1 },
                    { q: "Ø£ÙŠ Ø´ÙƒÙ„ Ù‡Ù†Ø¯Ø³ÙŠ ÙŠØ³ØªØ®Ø¯Ù… Ù„Ù„Ø¨Ø¯Ø§ÙŠØ© ÙˆØ§Ù„Ù†Ù‡Ø§ÙŠØ© ÙÙŠ Ø®Ø±Ø§Ø¦Ø· Ø§Ù„ØªØ¯ÙÙ‚ØŸ", options: ["Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„", "Ø§Ù„Ù…Ø¹ÙŠÙ†", "Ù…ØªÙˆØ§Ø²ÙŠ Ø§Ù„Ø£Ø¶Ù„Ø§Ø¹", "Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ¶Ø§ÙˆÙŠ"], answer: 3 },
                    { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø± (Ø³Ø¤Ø§Ù„) ÙÙŠ Ø®Ø±Ø§Ø¦Ø· Ø§Ù„ØªØ¯ÙÙ‚ØŸ", options: ["Ø§Ù„Ù…Ø¹ÙŠÙ†", "Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„", "Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ¶Ø§ÙˆÙŠ", "Ù…ØªÙˆØ§Ø²ÙŠ Ø§Ù„Ø£Ø¶Ù„Ø§Ø¹"], answer: 0 },
                    { q: "Ù„Ø­Ø³Ø§Ø¨ Ù…Ø³Ø§Ø­Ø© Ù…Ø³ØªØ·ÙŠÙ„ØŒ Ù†Ø³ØªØ®Ø¯Ù… Ø®Ø±ÙŠØ·Ø© ØªØ¯ÙÙ‚ Ù…Ù† Ù†ÙˆØ¹:", options: ["Ø§Ù„Ø¯ÙˆØ±Ø§Ù†", "Ø°Ø§Øª Ø§Ù„ÙØ±ÙˆØ¹", "Ø§Ù„ØªØªØ§Ø¨Ø¹ Ø§Ù„Ø¨Ø³ÙŠØ·", "Ø£ÙƒØ«Ø± Ù…Ù† Ø´Ø±Ø·"], answer: 2 }
                ]
            },
            { id: 2, category: 'cs', titleAr: "Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ© Ù„Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§", titleEn: "IT Infrastructure", instructorAr: "Ø¯.Ø´ÙŠÙ…Ø§Ø¡ Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø¤ÙˆÙ", instructorEn: "Dr. Shaimaa", img: "cover_network.jpg", files: { answers: { prefix: "net_ans_", count: 15 } }, quiz: [] },
            { id: 3, category: 'management', titleAr: "Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©", titleEn: "Strategic Management", instructorAr: "Ø¯. ÙˆÙ„Ø§Ø¡ Ø³Ø§Ù…ÛŒ", instructorEn: "Dr. Walaa", img: "cover_management.jpg", files: { answers: { prefix: "strat_ans_", count: 10 } }, quiz: [] },
            { id: 4, category: 'economics', titleAr: "Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ Ø§Ù„ÙƒÙ„ÙŠ", titleEn: "Macroeconomics", instructorAr: "Ø¯.Ù‡Ø¨Ø© Ø§Ù„Ù„Ù‡ Ø³Ù…ÙŠØ±", instructorEn: "Dr. Heba", img: "cover_economics.jpg", files: { answers: { prefix: "macro_ans_", count: 20 } }, quiz: [] },
            { id: 5, category: 'stats', titleAr: "Ø§Ù„Ø¥Ø­ØµØ§Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠ", titleEn: "Applied Statistics", instructorAr: "Ø¯. Ù…ÛŒØ±ÙØª Ø®Ù„ÙŠÙÙ‡", instructorEn: "Dr. Mervat", img: "cover_statistics.jpg", files: { answers: { prefix: "stat_ans_", count: 12 } }, quiz: [] }
        ];

        let currentCourse = null; let activeFilter = 'all';

        // === Ø§Ù„Ù…Ù„Ø®ØµØ§Øª ===
        const lecturesSummaries = {
            1: `<h3>Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø­Ø§Ø³Ø¨</h3>
                <ul>
                    <li><strong>Ø¯ÙˆØ±Ø© Ø­ÙŠØ§Ø© Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§Øª:</strong> 6 Ø®Ø·ÙˆØ§Øª (ØªØ­Ù„ÙŠÙ„ØŒ ØªØµÙ…ÙŠÙ…ØŒ Ø¨Ø±Ù…Ø¬Ø©ØŒ Ø§Ø®ØªØ¨Ø§Ø±ØŒ Ù†Ø´Ø±ØŒ ØµÙŠØ§Ù†Ø©).</li>
                    <li><strong>ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:</strong> Ù„Ø§Ø²Ù… Ù†Ø­Ø¯Ø¯ (Ø§Ù„Ù‡Ø¯ÙØŒ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§ØªØŒ Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª).</li>
                    <li><strong>Ø§Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ©:</strong> Ø®Ø·ÙˆØ§Øª Ù…Ø±ØªØ¨Ø© Ù„Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© (ØªÙ†Ø³Ø¨ Ù„Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠ).</li>
                </ul>
                <h3>Ø±Ù…ÙˆØ² Ø®Ø±Ø§Ø¦Ø· Ø§Ù„ØªØ¯ÙÙ‚:</h3>
                <ul>
                    <li><strong>Ø§Ù„Ø¨ÙŠØ¶Ø§ÙˆÙŠ:</strong> Ø¨Ø¯Ø§ÙŠØ© ÙˆÙ†Ù‡Ø§ÙŠØ©.</li>
                    <li><strong>Ù…ØªÙˆØ§Ø²ÙŠ Ø§Ù„Ø£Ø¶Ù„Ø§Ø¹:</strong> Ø¥Ø¯Ø®Ø§Ù„ ÙˆØ¥Ø®Ø±Ø§Ø¬ (Ø§Ù‚Ø±Ø£ / Ø§Ø·Ø¨Ø¹).</li>
                    <li><strong>Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„:</strong> Ø¹Ù…Ù„ÙŠØ§Øª Ø­Ø³Ø§Ø¨ÙŠØ© ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø©.</li>
                    <li><strong>Ø§Ù„Ù…Ø¹ÙŠÙ†:</strong> Ø§ØªØ®Ø§Ø° Ù‚Ø±Ø§Ø± (Ø³Ø¤Ø§Ù„ Ù†Ø¹Ù…/Ù„Ø§).</li>
                </ul>`
        };

        function openSummaryModal() { document.getElementById('summaryModal').style.display = 'flex'; renderLecturesList(); }
        function closeSummaryModal() { document.getElementById('summaryModal').style.display = 'none'; }
        function renderLecturesList() {
            const body = document.getElementById('summaryBodyArea'); const title = document.getElementById('summaryModalTitle'); const closeBtn = document.getElementById('summaryCloseBtn');
            title.innerText = currentLang === 'en' ? "Lectures List" : "Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª";
            closeBtn.onclick = closeSummaryModal; closeBtn.innerText = currentLang === 'en' ? 'arrow_back' : 'arrow_forward';
            let html = '';
            for (let i = 1; i <= 8; i++) {
                const lecName = currentLang === 'en' ? `Lecture ${i}` : `Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø© ${i}`;
                html += `<button class="lecture-btn" onclick="showLectureContent(${i})"><span>${lecName}</span><span class="material-icons" style="color:var(--text-grey); font-size:20px;">chevron_left</span></button>`;
            }
            body.innerHTML = html;
        }
        function showLectureContent(lectureId) {
            const body = document.getElementById('summaryBodyArea'); const title = document.getElementById('summaryModalTitle'); const closeBtn = document.getElementById('summaryCloseBtn');
            title.innerText = currentLang === 'en' ? `Lecture ${lectureId}` : `Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø© ${lectureId}`;
            closeBtn.onclick = renderLecturesList; 
            const content = lecturesSummaries[lectureId] || "<p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ø®Øµ Ù…ØªØ§Ø­ Ø­Ø§Ù„ÙŠØ§Ù‹.</p>";
            body.innerHTML = `<div class="lecture-content-view" style="display:block;">${content}</div>`;
        }

        // === Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ ===
        let currentQuizIndex = 0; let quizScore = 0;
        
        function openQuizModal() {
            if (!currentCourse.quiz || currentCourse.quiz.length === 0) {
                alert(currentLang === 'en' ? "No quiz available for this course yet!" : "Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù„Ù… ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ø¦Ù„Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø¯Ø© Ø¨Ø¹Ø¯.");
                return;
            }
            currentQuizIndex = 0; quizScore = 0;
            document.getElementById('quizModal').style.display = 'flex';
            renderQuizQuestion();
        }

        function closeQuizModal() { document.getElementById('quizModal').style.display = 'none'; }

        function renderQuizQuestion() {
            const container = document.getElementById('quizContainerBox');
            const qData = currentCourse.quiz[currentQuizIndex];
            let optionsHtml = '';
            qData.options.forEach((opt, idx) => {
                optionsHtml += `<button class="quiz-option" onclick="selectQuizAnswer(this, ${idx}, ${qData.answer})">
                                    <span>${opt}</span>
                                    <span class="material-icons opt-icon" style="display:none;"></span>
                                </button>`;
            });
            container.innerHTML = `
                <div class="quiz-progress">${currentLang === 'en' ? 'Question' : 'Ø§Ù„Ø³Ø¤Ø§Ù„'} ${currentQuizIndex + 1} / ${currentCourse.quiz.length}</div>
                <div class="quiz-question">${qData.q}</div>
                <div>${optionsHtml}</div>
                <button id="quizNextBtn" class="quiz-next-btn" onclick="nextQuizQuestion()">${currentLang === 'en' ? 'Next Question' : 'Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ'}</button>
            `;
        }

        function selectQuizAnswer(btnElement, selectedIdx, correctIdx) {
            const allOptions = document.querySelectorAll('.quiz-option');
            allOptions.forEach(opt => { opt.onclick = null; opt.style.pointerEvents = 'none'; });
            const icon = btnElement.querySelector('.opt-icon'); icon.style.display = 'block';

            if (selectedIdx === correctIdx) {
                btnElement.classList.add('correct'); icon.innerText = 'check_circle'; quizScore++;
            } else {
                btnElement.classList.add('wrong'); icon.innerText = 'cancel';
                allOptions[correctIdx].classList.add('correct');
                allOptions[correctIdx].querySelector('.opt-icon').innerText = 'check_circle';
                allOptions[correctIdx].querySelector('.opt-icon').style.display = 'block';
            }
            document.getElementById('quizNextBtn').style.display = 'block';
            if (currentQuizIndex === currentCourse.quiz.length - 1) {
                document.getElementById('quizNextBtn').innerText = currentLang === 'en' ? 'Show Result' : 'Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©';
            }
        }

        function nextQuizQuestion() {
            currentQuizIndex++;
            if (currentQuizIndex < currentCourse.quiz.length) { renderQuizQuestion(); } else { showQuizResult(); }
        }

        function showQuizResult() {
            const container = document.getElementById('quizContainerBox');
            const percentage = (quizScore / currentCourse.quiz.length) * 100;
            let msg = '';
            if (percentage >= 80) msg = currentLang === 'en' ? 'Excellent! You are a Pro ğŸš€' : 'Ø¹Ø§Ø´ ÙŠØ§ Ø¯Ø­ÙŠØ­! Ù…Ø³ØªÙˆØ§Ùƒ Ù…Ù…ØªØ§Ø² ğŸš€';
            else if (percentage >= 50) msg = currentLang === 'en' ? 'Good job, but you can do better ğŸ‘' : 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹ØŒ Ù…Ø­ØªØ§Ø¬ ØªØ±ÙƒÙŠØ² Ø£ÙƒØªØ± ğŸ‘';
            else msg = currentLang === 'en' ? 'You need to review the summary ğŸ“š' : 'Ù…Ø­ØªØ§Ø¬ ØªØ±Ø§Ø¬Ø¹ Ø§Ù„Ù…Ù„Ø®ØµØ§Øª ØªØ§Ù†ÙŠ ÙŠØ§ Ø¨Ø·Ù„ ğŸ“š';

            container.innerHTML = `
                <div class="quiz-result-box">
                    <h3 style="color:var(--title-color);">${currentLang === 'en' ? 'Your Score' : 'Ù†ØªÙŠØ¬ØªÙƒ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©'}</h3>
                    <div class="quiz-score">${quizScore} / ${currentCourse.quiz.length}</div>
                    <p style="color:var(--text-grey); font-size:1.1rem; margin-bottom:25px;">${msg}</p>
                    <button class="quiz-next-btn" style="display:block; background:#4caf50;" onclick="closeQuizModal()">${currentLang === 'en' ? 'Finish' : 'Ø¥Ù†Ù‡Ø§Ø¡'}</button>
                </div>
            `;
        }

        // ============================================
        function filterCourses(category, btn) {
            activeFilter = category; document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active')); if(btn) btn.classList.add('active');
            if (category === 'all') renderCourses(coursesData); else renderCourses(coursesData.filter(c => c.category === category));
        }

        function updateCompletedCountBadge() {
            let count = 0; coursesData.forEach(c => { if(localStorage.getItem('completed_' + c.id) === 'true') count++; });
            const badge = document.getElementById('completedCountBadge'); if (badge) badge.innerText = count;
        }

        const container = document.getElementById('coursesListContainer');
        function renderCourses(list) {
            container.innerHTML = '';
            if (list.length === 0) { container.innerHTML = `<div style="text-align:center; padding:20px; color:var(--text-grey);">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¯</div>`; return; }
            list.forEach(course => {
                const isCompleted = localStorage.getItem('completed_' + course.id) === 'true';
                const compText = currentLang === 'en' ? 'Completed' : 'ØªÙ…Øª Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©';
                container.innerHTML += `
                <div class="course-card-vertical ${isCompleted ? 'is-completed' : ''}" onclick="openPlayer(${course.id})">
                    <img src="${course.img}" class="cc-v-image">
                    <div class="cc-v-content">
                        <div>
                            <div class="completed-badge"><span class="material-icons" style="font-size:14px; margin-inline-end: 4px;">check_circle</span> ${compText}</div>
                            <h4 style="color:var(--title-color); font-size:1rem;">${currentLang === 'en' ? course.titleEn : course.titleAr}</h4>
                            <p style="color:var(--text-grey); font-size:0.85rem; margin-top:5px;">${currentLang === 'en' ? course.instructorEn : course.instructorAr}</p>
                        </div>
                    </div>
                </div>`;
            });
        }

        document.getElementById('searchInput').addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase(); const baseData = activeFilter === 'all' ? coursesData : coursesData.filter(c => c.category === activeFilter);
            renderCourses(baseData.filter(c => c.titleAr.toLowerCase().includes(term) || c.titleEn.toLowerCase().includes(term)));
        });

        function switchTab(tabName, element) {
            document.querySelectorAll('.page-section').forEach(p => { if(p.id !== 'page-player') p.classList.remove('active'); });
            document.getElementById('page-' + tabName).classList.add('active');
            if(element) { document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active')); element.classList.add('active'); }
            if(tabName === 'profile') updateCompletedCountBadge();
        }

        function openPlayer(id) {
            currentCourse = coursesData.find(c => c.id === id);
            document.getElementById('playerCourseTitle').innerText = currentLang === 'en' ? currentCourse.titleEn : currentCourse.titleAr;
            document.getElementById('playerInstructor').innerText = currentLang === 'en' ? currentCourse.instructorEn : currentCourse.instructorAr;
            document.getElementById('page-player').style.display = 'block'; document.getElementById('bottomNav').style.display = 'none'; document.getElementById('mainHeader').style.display = 'none'; document.querySelector('.news-ticker').style.display = 'none';
            updateCompletionUI(); 
        }

        function closePlayer() { document.getElementById('page-player').style.display = 'none'; document.getElementById('bottomNav').style.display = 'flex'; document.getElementById('mainHeader').style.display = 'flex'; document.querySelector('.news-ticker').style.display = 'flex'; }
        
        function toggleCourseCompletion() {
            const key = 'completed_' + currentCourse.id; localStorage.setItem(key, localStorage.getItem(key) === 'true' ? 'false' : 'true');
            updateCompletionUI(); if(activeFilter === 'all') renderCourses(coursesData); else filterCourses(activeFilter, null); updateCompletedCountBadge(); 
        }

        function updateCompletionUI() {
            const isCompleted = localStorage.getItem('completed_' + currentCourse.id) === 'true';
            const btn = document.getElementById('completeCourseBtn'); const text = document.getElementById('completeBtnText'); const icon = document.getElementById('completeBtnIcon');
            if(isCompleted) { btn.style.background = '#e8f5e9'; btn.style.color = '#2e7d32'; btn.style.border = '2px solid #2e7d32'; text.innerText = currentLang === 'en' ? 'Course Completed' : 'ØªÙ… Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ù…Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­'; icon.innerText = 'task_alt'; } 
            else { btn.style.background = 'transparent'; btn.style.color = 'var(--text-grey)'; btn.style.border = '2px solid var(--text-grey)'; text.innerText = currentLang === 'en' ? 'Mark as Completed' : 'ØªØ­Ø¯ÙŠØ¯ ÙƒÙ…Ø§Ø¯Ø© Ù…ÙƒØªÙ…Ù„Ø©'; icon.innerText = 'radio_button_unchecked'; }
        }

        // ============================================
        // Ø§Ù„Ø²ÙˆÙˆÙ… ÙˆØ§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ© Ø§Ù„Ù…Ø¯Ù…Ø¬Ø© (ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ±)
        let currentZoomLevel = 100; 
        
        // Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§: Ø§Ù„Ø²ÙˆÙˆÙ… Ø¨ÙŠØ·Ø¨Ù‚ Ø¹Ù„Ù‰ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù„ÙŠ Ø¬ÙˆØ§Ù‡ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ© Ù…Ø¹ Ø¨Ø¹Ø¶ Ø¹Ø´Ø§Ù† ÙŠÙƒØ¨Ø±ÙˆØ§ Ø³ÙˆØ§!
        function zoomImages(change) { 
            currentZoomLevel += change; 
            if (currentZoomLevel < 50) currentZoomLevel = 50; 
            if (currentZoomLevel > 300) currentZoomLevel = 300; 
            document.getElementById('imagesWrapper').style.width = currentZoomLevel + '%'; 
        }

        function showProtectedImage(type) {
            const fileData = currentCourse.files[type]; 
            const modal = document.getElementById('imageModal');
            const imagesWrapper = document.getElementById('imagesWrapper');
            const watermarkContainer = document.getElementById('watermarkOverlay');
            
            currentZoomLevel = 100;
            imagesWrapper.style.width = '100%'; // ØªØµÙÙŠØ± Ø§Ù„Ø²ÙˆÙˆÙ… Ù…Ø¹ ÙƒÙ„ ÙØªØ­Ø© Ø¬Ø¯ÙŠØ¯Ø©
            
            imagesWrapper.querySelectorAll('img').forEach(img => img.remove());
            
            for (let i = 1; i <= fileData.count; i++) {
                const imgElement = document.createElement('img'); 
                imgElement.src = fileData.prefix + i + '.jpg'; 
                imgElement.className = 'protected-img'; 
                imgElement.style.width = '100%'; 
                imgElement.onerror = function() { imgElement.alt = 'Error'; imgElement.style.border = "1px solid red"; imgElement.style.padding = "20px"; };
                
                // Ø¥Ø¯Ø±Ø§Ø¬ Ø§Ù„ØµÙˆØ± Ù‚Ø¨Ù„ Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ© Ø¹Ø´Ø§Ù† ØªÙØ¶Ù„ Ø§Ù„Ø¹Ù„Ø§Ù…Ø© ÙÙˆÙ‚Ù‡Ù…
                imagesWrapper.insertBefore(imgElement, watermarkContainer);
            }
            
            watermarkContainer.innerHTML = ''; 
            const watermarkText = `${studentFullName} - ${studentCode}`;
            
            // ØªÙ… Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ø¯Ø¯ Ù„Ù€ 400 Ù„Ø¶Ù…Ø§Ù† ØªØºØ·ÙŠØ© ÙƒÙ„ Ø§Ù„ØµÙØ­Ø§Øª Ù…Ù‡Ù…Ø§ ÙƒØ§Ù† Ø·ÙˆÙ„ Ø§Ù„Ù…Ø°ÙƒØ±Ø©
            for (let i = 0; i < 400; i++) { 
                const span = document.createElement('div'); 
                span.className = 'watermark-text'; 
                span.innerText = watermarkText; 
                watermarkContainer.appendChild(span); 
            }
            
            modal.style.display = 'flex';
        }

        function closeImageModal() { document.getElementById('imageModal').style.display = 'none'; }
        function logout() { localStorage.clear(); window.location.href = 'login.html'; }

        let pomoInterval; let pomoTime = 25 * 60; let isPomoRunning = false;
        function updatePomoDisplay() { let m = Math.floor(pomoTime / 60); let s = pomoTime % 60; document.getElementById('pomoTimeDisplay').innerText = (m < 10 ? '0'+m : m) + ':' + (s < 10 ? '0'+s : s); }
        function togglePomodoro() { let timerDiv = document.getElementById('pomodoroTimer'); timerDiv.style.display = timerDiv.style.display === 'none' ? 'block' : 'none'; }
        function startPomodoro() { if(isPomoRunning) { clearInterval(pomoInterval); document.getElementById('pomoStartBtn').innerText = currentLang === 'en' ? 'Resume' : 'Ø§Ø³ØªÙƒÙ…Ø§Ù„'; isPomoRunning = false; } else { pomoInterval = setInterval(() => { if(pomoTime > 0) { pomoTime--; updatePomoDisplay(); } else { clearInterval(pomoInterval); alert("ÙˆÙ‚Øª Ø§Ù„Ø±Ø§Ø­Ø©!"); resetPomodoro(); } }, 1000); document.getElementById('pomoStartBtn').innerText = currentLang === 'en' ? 'Pause' : 'Ø¥ÙŠÙ‚Ø§Ù'; isPomoRunning = true; } }
        function resetPomodoro() { clearInterval(pomoInterval); pomoTime = 25 * 60; isPomoRunning = false; document.getElementById('pomoStartBtn').innerText = currentLang === 'en' ? 'Start' : 'Ø¨Ø¯Ø£'; updatePomoDisplay(); }

        applyLanguage(); updatePomoDisplay(); updateCompletedCountBadge(); 
    </script>
</body>
</html>