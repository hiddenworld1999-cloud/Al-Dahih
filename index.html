<script>
document.addEventListener('DOMContentLoaded', () => {
    // التحقق من تسجيل الدخول
    if (localStorage.getItem('isLoggedInDaheeh') !== 'true') {
        window.location.href = 'login.html';
        return;
    }

    const studentName = localStorage.getItem('studentName') || 'طالب الدحيح';

    // الداتا
    const coursesData = [
        { id: 1, title: "تصميم برامج الحاسب", instructor: "د. تامر البرمجيات", rating: "4.8", img: "https://placehold.co/200x300/0A2647/FFC800?text=Code" },
        { id: 2, title: "البنية التحتية للتكنولوجيا", instructor: "م. علي الشبكات", rating: "4.7", img: "https://placehold.co/200x300/FFC800/0A2647?text=Network" },
        { id: 3, title: "الإدارة الإستراتيجية", instructor: "د. هالة الإدارية", rating: "4.9", img: "https://placehold.co/200x300/0A2647/FFF?text=Strategy" },
        { id: 4, title: "الاقتصاد الكلي", instructor: "د. وائل الاقتصادي", rating: "4.6", img: "https://placehold.co/200x300/FFC800/FFF?text=Macro" },
        { id: 5, title: "الإحصاء التطبيقي", instructor: "د. رانيا الأرقام", rating: "4.8", img: "https://placehold.co/200x300/0A2647/FFC800?text=Stats" }
    ];

    const container = document.getElementById('coursesListContainer');

    function renderCourses(courses) {
        container.innerHTML = '';
        courses.forEach(course => {
            const card = document.createElement('div');
            card.className = 'course-card-vertical';
            card.onclick = () => openPlayer(course.id);

            const imgContainer = document.createElement('div');
            imgContainer.className = 'cc-v-image-container';
            imgContainer.style.position = 'relative';

            const img = document.createElement('img');
            img.src = course.img;
            img.className = 'cc-v-image';

            // إضافة العلامة المائية
            const watermark = document.createElement('div');
            watermark.innerText = studentName;
            watermark.style.position = 'absolute';
            watermark.style.bottom = '8px';
            watermark.style.right = '8px';
            watermark.style.fontSize = '12px';
            watermark.style.color = 'rgba(255,255,255,0.6)';
            watermark.style.background = 'rgba(0,0,0,0.15)';
            watermark.style.padding = '2px 5px';
            watermark.style.borderRadius = '4px';
            watermark.style.pointerEvents = 'none';
            watermark.style.fontWeight = '700';

            imgContainer.appendChild(img);
            imgContainer.appendChild(watermark);

            const content = document.createElement('div');
            content.className = 'cc-v-content';
            content.innerHTML = `
                <div>
                    <h4 class="cc-v-title">${course.title}</h4>
                    <p class="cc-v-instructor"><span class="material-icons" style="font-size:16px; margin-left:4px">person</span> ${course.instructor}</p>
                </div>
                <div class="cc-v-footer">
                    <span class="rating-badge"><span class="material-icons" style="font-size:16px; margin-left:2px">star</span> ${course.rating}</span>
                </div>
            `;

            card.appendChild(imgContainer);
            card.appendChild(content);
            container.appendChild(card);
        });
    }

    renderCourses(coursesData);

    // البحث
    const searchInput = document.getElementById('searchInput');
    searchInput.addEventListener('input', (e) => {
        const searchTerm = e.target.value.toLowerCase();
        const filtered = coursesData.filter(c => c.title.includes(searchTerm));
        renderCourses(filtered);
    });
});
</script>